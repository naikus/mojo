<?xml version="1.0"?>
<project basedir="." default="build"> 
  <target name="combine" depends="mkdist">
    <!-- Order is important here -->
    <concat destfile="dist/mojo.js">
      <fileset dir="." includes="LICENSE" />
      <filelist dir="src">
        <file name="env.js"/>
        <file name="template.js"/>
        <file name="datalist.js"/>
        <file name="form.js"/>
        <file name="app.js"/>
      </filelist>
    </concat>
    
    <concat destfile="dist/mojo.css">
      <fileset dir="." includes="LICENSE" />
      <filelist dir="src">
        <file name="style/view-transitions.css"/>
        <file name="style/theme.css"/>
      </filelist>
    </concat>
  </target>
  
  <target name="mkdist">
    <mkdir dir="dist" />
  </target>
  
  <target name="build" depends="clean,combine">
    <antcall target="minify" />
  </target>

  <target name="minify" depends="mkdist">
    <java jar="build-tools/yuicompressor-2.4.7.jar" fork="true">
        <arg line="-o dist/mojo.min.js --preserve-semi dist/mojo.js"/>
    </java>
    <java jar="build-tools/yuicompressor-2.4.7.jar" fork="true">
        <arg line="-o dist/mojo.min.css --preserve-semi dist/mojo.css"/>
    </java>    
  </target>

  <target name="clean">
    <delete file="dist/mojo.js" />
    <delete file="dist/mojo.min.js" />
    <delete file="dist/mojo.css" />
    <delete file="dist/mojo.min.css" />
  </target>
</project>
